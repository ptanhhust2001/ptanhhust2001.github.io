<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr√¨nh kh√°m ph√° T∆∞∆°ng t√°c: Ph√¢n t√≠ch Log v·ªõi Elastic Stack</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Harmony Neutrals (#f8f7f4, #3a3a3a, #a3b8c2, #d8c3a5, #8e8d8a, #e98074) -->
    <!-- Application Structure Plan: A task-oriented, single-page dashboard guiding users through the log analysis lifecycle (Collection -> Processing/Storage -> Analysis). It uses an interactive flowchart for overview, a tool selector for collection, a simulated debugger for processing, and a dynamic dashboard for analysis. This structure prioritizes hands-on learning and exploration over passive reading, making complex concepts more digestible and engaging for the user. -->
    <!-- Visualization & Content Choices:
        - Report Info: Overall log analysis workflow. Goal: Orient user. Viz: Interactive HTML/CSS flowchart. Interaction: Hover/click to reveal info & navigate. Justification: Provides a mental model of the entire process upfront. Library: Vanilla JS.
        - Report Info: Comparison of log shippers (Filebeat, Logstash, etc.). Goal: Compare options. Viz: Interactive comparison table & Chart.js Bar Chart. Interaction: Select criteria to highlight tools. Justification: Helps users make an informed choice based on their needs. Library: Chart.js, Vanilla JS.
        - Report Info: Logstash Grok parsing. Goal: Explain a complex concept. Viz: Simulated Grok Debugger (HTML form). Interaction: User enters data/pattern, sees live result. Justification: Active learning is far more effective than static explanation for a technical task. Library: Vanilla JS.
        - Report Info: ILM Hot/Warm/Cold phases. Goal: Show change over time. Viz: HTML/CSS timeline diagram. Interaction: Hover over phases. Justification: Visually represents a time-based process effectively. Library: Vanilla JS.
        - Report Info: Kibana analysis (error rates, top IPs). Goal: Simulate analysis. Viz: Interactive dashboard with Chart.js charts (Line, Bar, Pie, Table). Interaction: User selects filters from a dropdown to update all charts. Justification: Demonstrates the end-result and power of the system in a dynamic, hands-on way. Library: Chart.js, Vanilla JS.
        - Report Info: Best practices. Goal: Inform/summarize. Viz: Accordion list. Interaction: Click to expand. Justification: Presents dense info in a compact, organized manner. Library: Vanilla JS.
        -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f7f4;
            color: #3a3a3a;
        }
        .chart-container {
            position: relative;
            width: 100%;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .nav-link {
            transition: color 0.3s, border-color 0.3s;
        }
        .nav-link:hover, .nav-link.active {
            color: #e98074;
            border-bottom-color: #e98074;
        }
        .flowchart-node {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .flowchart-node:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .flowchart-arrow {
            font-size: 2rem;
            color: #a3b8c2;
        }
        .custom-tab {
            transition: all 0.3s;
            border-bottom: 2px solid transparent;
        }
        .custom-tab.active {
            border-bottom-color: #e98074;
            color: #e98074;
            font-weight: 600;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-md shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold text-gray-800">üöÄ Elastic Log Explorer</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#overview" class="nav-link text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">T·ªïng quan</a>
                        <a href="#collection" class="nav-link text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">Thu th·∫≠p Log</a>
                        <a href="#processing" class="nav-link text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">X·ª≠ l√Ω & L∆∞u tr·ªØ</a>
                        <a href="#analysis" class="nav-link text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">Ph√¢n t√≠ch</a>
                        <a href="#best-practices" class="nav-link text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">Th·ª±c h√†nh t·ªët nh·∫•t</a>
                    </div>
                </div>
                 <div class="md:hidden">
                    <button id="mobile-menu-button" class="p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100">
                        <span class="sr-only">Open main menu</span>
                        <div id="hamburger-icon">
                            <div class="w-6 h-0.5 bg-gray-600 mb-1.5"></div>
                            <div class="w-6 h-0.5 bg-gray-600 mb-1.5"></div>
                            <div class="w-6 h-0.5 bg-gray-600"></div>
                        </div>
                    </button>
                </div>
            </div>
            <div id="mobile-menu" class="md:hidden hidden pb-3">
                <a href="#overview" class="block nav-link text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-base font-medium">T·ªïng quan</a>
                <a href="#collection" class="block nav-link text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-base font-medium">Thu th·∫≠p Log</a>
                <a href="#processing" class="block nav-link text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-base font-medium">X·ª≠ l√Ω & L∆∞u tr·ªØ</a>
                <a href="#analysis" class="block nav-link text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-base font-medium">Ph√¢n t√≠ch</a>
                <a href="#best-practices" class="block nav-link text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-base font-medium">Th·ª±c h√†nh t·ªët nh·∫•t</a>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        
        <!-- Section: Overview -->
        <section id="overview" class="mb-16 md:mb-24 text-center scroll-mt-20">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4">H√†nh tr√¨nh c·ªßa D·ªØ li·ªáu Log</h2>
            <p class="max-w-3xl mx-auto text-lg text-gray-600 mb-12">Kh√°m ph√° c√°ch Elastic Stack bi·∫øn nh·ªØng d√≤ng log th√¥ t·ª´ h·ªá th·ªëng c·ªßa b·∫°n th√†nh nh·ªØng insight gi√° tr·ªã. M·ªói b∆∞·ªõc trong quy tr√¨nh ƒë·ªÅu ƒë√≥ng vai tr√≤ quan tr·ªçng. H√£y nh·∫•p v√†o t·ª´ng giai ƒëo·∫°n ƒë·ªÉ t√¨m hi·ªÉu th√™m.</p>
            <div class="flex flex-col md:flex-row items-center justify-center space-y-8 md:space-y-0 md:space-x-4">
                <div class="flowchart-node bg-white p-6 rounded-xl shadow-lg w-full md:w-52" data-target="#collection">
                    <div class="text-4xl mb-3">üìÑ</div>
                    <h3 class="text-lg font-semibold">1. Thu th·∫≠p</h3>
                    <p class="text-sm text-gray-500">Gom log t·ª´ m·ªçi ngu·ªìn.</p>
                </div>
                <div class="flowchart-arrow transform md:rotate-0 rotate-90">‚Üí</div>
                <div class="flowchart-node bg-white p-6 rounded-xl shadow-lg w-full md:w-52" data-target="#processing">
                    <div class="text-4xl mb-3">‚öôÔ∏è</div>
                    <h3 class="text-lg font-semibold">2. X·ª≠ l√Ω</h3>
                    <p class="text-sm text-gray-500">Chu·∫©n h√≥a & l√†m gi√†u d·ªØ li·ªáu.</p>
                </div>
                <div class="flowchart-arrow transform md:rotate-0 rotate-90">‚Üí</div>
                <div class="flowchart-node bg-white p-6 rounded-xl shadow-lg w-full md:w-52" data-target="#processing">
                     <div class="text-4xl mb-3">üóÑÔ∏è</div>
                    <h3 class="text-lg font-semibold">3. L∆∞u tr·ªØ</h3>
                    <p class="text-sm text-gray-500">L·∫≠p ch·ªâ m·ª•c trong Elasticsearch.</p>
                </div>
                <div class="flowchart-arrow transform md:rotate-0 rotate-90">‚Üí</div>
                <div class="flowchart-node bg-white p-6 rounded-xl shadow-lg w-full md:w-52" data-target="#analysis">
                    <div class="text-4xl mb-3">üìä</div>
                    <h3 class="text-lg font-semibold">4. Ph√¢n t√≠ch</h3>
                    <p class="text-sm text-gray-500">Tr·ª±c quan h√≥a v·ªõi Kibana.</p>
                </div>
            </div>
        </section>

        <!-- Section: Collection -->
        <section id="collection" class="mb-16 md:mb-24 scroll-mt-20">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4 text-center">Giai ƒëo·∫°n 1: L·ª±a ch·ªçn C√¥ng c·ª• Thu th·∫≠p Log</h2>
            <p class="max-w-3xl mx-auto text-lg text-gray-600 mb-12 text-center">B∆∞·ªõc ƒë·∫ßu ti√™n l√† ƒë∆∞a log t·ª´ c√°c h·ªá th·ªëng c·ªßa b·∫°n v√†o Elastic. Vi·ªác l·ª±a ch·ªçn c√¥ng c·ª• ph√π h·ª£p ph·ª• thu·ªôc v√†o nhu c·∫ßu c·ªßa b·∫°n v·ªÅ hi·ªáu nƒÉng v√† kh·∫£ nƒÉng x·ª≠ l√Ω.</p>
            <div class="bg-white rounded-xl shadow-lg p-6 md:p-8">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-xl font-semibold mb-4">So s√°nh c√°c C√¥ng c·ª• Thu th·∫≠p</h3>
                        <p class="text-gray-600 mb-6">M·ªói c√¥ng c·ª• c√≥ ƒëi·ªÉm m·∫°nh ri√™ng. Filebeat nh·∫π nh√†ng, Logstash m·∫°nh m·∫Ω trong x·ª≠ l√Ω, v√† Elastic Agent mang ƒë·∫øn gi·∫£i ph√°p h·ª£p nh·∫•t.</p>
                        <div class="chart-container">
                            <canvas id="collectorChart"></canvas>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold mb-4">C·∫•u h√¨nh M·∫´u</h3>
                        <div class="border-b border-gray-200 mb-4">
                            <nav class="-mb-px flex space-x-4" aria-label="Tabs">
                                <button class="custom-tab whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm active" data-tab="filebeat">Filebeat</button>
                                <button class="custom-tab whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm" data-tab="logstash">Logstash</button>
                                <button class="custom-tab whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm" data-tab="agent">Elastic Agent</button>
                            </nav>
                        </div>
                        <div id="tab-content">
                            <!-- Filebeat Content -->
                            <div class="tab-pane active" id="filebeat-content">
                                <p class="text-gray-600 mb-4">Filebeat l√† l·ª±a ch·ªçn l√Ω t∆∞·ªüng ƒë·ªÉ chuy·ªÉn ti·∫øp log t·ª´ nhi·ªÅu m√°y ch·ªß v·ªõi t√†i nguy√™n t·ªëi thi·ªÉu. S·ª≠ d·ª•ng c√°c module ƒë·ªÉ t·ª± ƒë·ªông ph√¢n t√≠ch c√°c ƒë·ªãnh d·∫°ng log ph·ªï bi·∫øn.</p>
                                <select id="filebeat-log-type" class="w-full p-2 border rounded-md mb-2 bg-gray-50">
                                    <option value="nginx">Log Nginx</option>
                                    <option value="apache">Log Apache</option>
                                    <option value="json">Log JSON T√πy ch·ªânh</option>
                                </select>
                                <pre class="bg-gray-800 text-white p-4 rounded-md text-sm overflow-x-auto"><code id="filebeat-code"></code></pre>
                            </div>
                             <!-- Logstash Content -->
                            <div class="tab-pane hidden" id="logstash-content">
                                <p class="text-gray-600 mb-4">Logstash l√† m·ªôt pipeline x·ª≠ l√Ω m·∫°nh m·∫Ω, cho ph√©p b·∫°n ph√¢n t√≠ch, l√†m gi√†u v√† bi·∫øn ƒë·ªïi log tr∆∞·ªõc khi g·ª≠i ƒë·∫øn Elasticsearch. R·∫•t linh ho·∫°t nh·ªù h·ªá th·ªëng plugin phong ph√∫.</p>
                                <select id="logstash-log-type" class="w-full p-2 border rounded-md mb-2 bg-gray-50">
                                    <option value="apache">Ph√¢n t√≠ch Log Apache</option>
                                    <option value="syslog">Nh·∫≠n Syslog</option>
                                    <option value="beats">Nh·∫≠n t·ª´ Filebeat</option>
                                </select>
                                <pre class="bg-gray-800 text-white p-4 rounded-md text-sm overflow-x-auto"><code id="logstash-code"></code></pre>
                            </div>
                            <!-- Elastic Agent Content -->
                            <div class="tab-pane hidden" id="agent-content">
                                <p class="text-gray-600 mb-4">Elastic Agent l√† m·ªôt agent h·ª£p nh·∫•t cho logs, metrics, v√† security data. Qu·∫£n l√Ω t·∫≠p trung qua Fleet gi√∫p ƒë∆°n gi·∫£n h√≥a vi·ªác tri·ªÉn khai v√† n√¢ng c·∫•p.</p>
                                <p class="text-gray-600 mb-2">C·∫•u h√¨nh cho Elastic Agent th∆∞·ªùng ƒë∆∞·ª£c qu·∫£n l√Ω th√¥ng qua giao di·ªán c·ªßa Kibana (Fleet) thay v√¨ c√°c file YAML tƒ©nh, gi√∫p ƒë∆°n gi·∫£n h√≥a vi·ªác thi·∫øt l·∫≠p cho c√°c d·ªãch v·ª• ph·ªï bi·∫øn nh∆∞ Nginx, System, Docker...</p>
                                <div class="bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg">
                                    <div class="flex">
                                        <div class="flex-shrink-0">
                                            <span class="text-2xl">üí°</span>
                                        </div>
                                        <div class="ml-3">
                                            <p class="text-sm text-blue-700">
                                            V·ªõi Elastic Agent, b·∫°n ch·ªâ c·∫ßn ch·ªçn "Integration" (v√≠ d·ª•: Nginx) trong Fleet, cung c·∫•p ƒë∆∞·ªùng d·∫´n log, v√† Agent s·∫Ω t·ª± ƒë·ªông √°p d·ª•ng c·∫•u h√¨nh, pipeline x·ª≠ l√Ω v√† dashboard t∆∞∆°ng ·ª©ng.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section: Processing & Storage -->
        <section id="processing" class="mb-16 md:mb-24 scroll-mt-20">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4 text-center">Giai ƒëo·∫°n 2: X·ª≠ l√Ω v√† L∆∞u tr·ªØ D·ªØ li·ªáu</h2>
            <p class="max-w-3xl mx-auto text-lg text-gray-600 mb-12 text-center">ƒê√¢y l√† b∆∞·ªõc bi·∫øn d·ªØ li·ªáu th√¥ th√†nh th√¥ng tin c√≥ c·∫•u tr√∫c. Ch√∫ng ta s·∫Ω kh√°m ph√° c√°ch ph√¢n t√≠ch log v·ªõi Grok v√† qu·∫£n l√Ω v√≤ng ƒë·ªùi d·ªØ li·ªáu v·ªõi ILM.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Grok Parser -->
                <div class="bg-white rounded-xl shadow-lg p-6 md:p-8">
                    <h3 class="text-xl font-semibold mb-4">Th·ª≠ nghi·ªám Grok Parser</h3>
                    <p class="text-gray-600 mb-4">Grok cho ph√©p b·∫°n ƒë·∫∑t t√™n cho c√°c m·∫´u c√≥ s·∫µn ƒë·ªÉ ph√¢n t√≠ch c√∫ ph√°p log. H√£y th·ª≠ v·ªõi m·ªôt d√≤ng log Apache v√† xem k·∫øt qu·∫£.</p>
                    <div class="mb-4">
                        <label for="grok-input" class="block text-sm font-medium text-gray-700">D√≤ng Log M·∫´u (Apache Common Log)</label>
                        <textarea id="grok-input" rows="2" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">127.0.0.1 - frank [10/Oct/2000:13:55:36 -0700] "GET /apache_pb.gif HTTP/1.0" 200 2326</textarea>
                    </div>
                    <div class="mb-4">
                        <label for="grok-pattern" class="block text-sm font-medium text-gray-700">M·∫´u Grok</label>
                         <input id="grok-pattern" type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" value="%{IPORHOST:clientip} %{USER:ident} %{USER:auth} \[%{HTTPDATE:timestamp}\] \"(?:%{WORD:verb} %{NOTSPACE:request}(?: HTTP/%{NUMBER:httpversion})?|%{DATA:rawrequest})\" %{NUMBER:response:int} (?:-|%{NUMBER:bytes:int})">
                    </div>
                    <button id="grok-parse-btn" class="w-full bg-[#d8c3a5] hover:bg-[#c9b494] text-white font-bold py-2 px-4 rounded-lg transition-colors">Ph√¢n t√≠ch (Parse)</button>
                    <div class="mt-4">
                        <h4 class="font-semibold">K·∫øt qu·∫£ JSON:</h4>
                        <pre class="bg-gray-800 text-white p-4 rounded-md text-sm overflow-x-auto mt-2"><code id="grok-output">{"message": "H√£y nh·∫•n n√∫t Ph√¢n t√≠ch"}</code></pre>
                    </div>
                </div>

                <!-- ILM -->
                <div class="bg-white rounded-xl shadow-lg p-6 md:p-8">
                    <h3 class="text-xl font-semibold mb-4">V√≤ng ƒë·ªùi D·ªØ li·ªáu Log (ILM)</h3>
                    <p class="text-gray-600 mb-6">D·ªØ li·ªáu log kh√¥ng c·∫ßn l∆∞u tr·ªØ m√£i m√£i v·ªõi hi·ªáu nƒÉng cao nh·∫•t. ILM t·ª± ƒë·ªông di chuy·ªÉn d·ªØ li·ªáu qua c√°c t·∫ßng ƒë·ªÉ t·ªëi ∆∞u chi ph√≠ v√† hi·ªáu su·∫•t. Di chu·ªôt qua c√°c giai ƒëo·∫°n ƒë·ªÉ xem chi ti·∫øt.</p>
                    <div class="space-y-4">
                        <div class="ilm-phase relative p-4 bg-red-100 border-l-4 border-red-500 rounded-r-lg">
                            <h4 class="font-bold text-red-800">üî• HOT</h4>
                            <div class="ilm-details absolute left-full ml-4 w-64 bg-white p-4 rounded-lg shadow-xl hidden z-10 border border-gray-200">
                                <h5 class="font-bold mb-2">T·ªëi ∆∞u cho Ghi & Truy v·∫•n</h5>
                                <p class="text-sm text-gray-600">D·ªØ li·ªáu ƒë∆∞·ª£c ghi v√† truy v·∫•n li√™n t·ª•c. Y√™u c·∫ßu hi·ªáu nƒÉng cao nh·∫•t. Th∆∞·ªùng l∆∞u tr√™n SSD.</p>
                                <p class="text-sm text-gray-600 mt-2"><strong>H√†nh ƒë·ªông:</strong> `rollover` (t·∫°o index m·ªõi khi ƒë·∫ßy).</p>
                            </div>
                        </div>
                        <div class="ilm-phase relative p-4 bg-yellow-100 border-l-4 border-yellow-500 rounded-r-lg">
                            <h4 class="font-bold text-yellow-800">üå§Ô∏è WARM</h4>
                            <div class="ilm-details absolute left-full ml-4 w-64 bg-white p-4 rounded-lg shadow-xl hidden z-10 border border-gray-200">
                                <h5 class="font-bold mb-2">T·ªëi ∆∞u cho L∆∞u tr·ªØ</h5>
                                <p class="text-sm text-gray-600">D·ªØ li·ªáu √≠t ƒë∆∞·ª£c truy v·∫•n, ch·ªâ ƒë·ªçc. C√≥ th·ªÉ chuy·ªÉn sang ph·∫ßn c·ª©ng r·∫ª h∆°n.</p>
                                <p class="text-sm text-gray-600 mt-2"><strong>H√†nh ƒë·ªông:</strong> `shrink` (gi·∫£m shard), `forcemerge` (g·ªôp segment).</p>
                            </div>
                        </div>
                        <div class="ilm-phase relative p-4 bg-blue-100 border-l-4 border-blue-500 rounded-r-lg">
                            <h4 class="font-bold text-blue-800">‚ùÑÔ∏è COLD</h4>
                             <div class="ilm-details absolute left-full ml-4 w-64 bg-white p-4 rounded-lg shadow-xl hidden z-10 border border-gray-200">
                                <h5 class="font-bold mb-2">L∆∞u tr·ªØ D√†i h·∫°n</h5>
                                <p class="text-sm text-gray-600">D·ªØ li·ªáu r·∫•t hi·∫øm khi truy c·∫≠p. Gi·∫£m thi·ªÉu t√†i nguy√™n s·ª≠ d·ª•ng.</p>
                                <p class="text-sm text-gray-600 mt-2"><strong>H√†nh ƒë·ªông:</strong> `freeze` (ƒë√≥ng bƒÉng index), `searchable snapshots`.</p>
                            </div>
                        </div>
                         <div class="ilm-phase relative p-4 bg-gray-200 border-l-4 border-gray-500 rounded-r-lg">
                            <h4 class="font-bold text-gray-800">üóëÔ∏è DELETE</h4>
                             <div class="ilm-details absolute left-full ml-4 w-64 bg-white p-4 rounded-lg shadow-xl hidden z-10 border border-gray-200">
                                <h5 class="font-bold mb-2">X√≥a D·ªØ li·ªáu</h5>
                                <p class="text-sm text-gray-600">T·ª± ƒë·ªông x√≥a index sau m·ªôt kho·∫£ng th·ªùi gian nh·∫•t ƒë·ªãnh ƒë·ªÉ gi·∫£i ph√≥ng dung l∆∞·ª£ng.</p>
                                <p class="text-sm text-gray-600 mt-2"><strong>H√†nh ƒë·ªông:</strong> `delete`.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section: Analysis -->
        <section id="analysis" class="mb-16 md:mb-24 scroll-mt-20">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4 text-center">Giai ƒëo·∫°n 3: Ph√¢n t√≠ch & Tr·ª±c quan h√≥a v·ªõi Kibana</h2>
            <p class="max-w-3xl mx-auto text-lg text-gray-600 mb-12 text-center">ƒê√¢y l√† l√∫c s·ª©c m·∫°nh c·ªßa Elastic Stack t·ªèa s√°ng. Kh√°m ph√° dashboard m√¥ ph·ªèng d∆∞·ªõi ƒë√¢y ƒë·ªÉ xem c√°ch d·ªØ li·ªáu log ƒë∆∞·ª£c bi·∫øn th√†nh c√°c bi·ªÉu ƒë·ªì v√† insight h·ªØu √≠ch.</p>
            <div class="bg-white rounded-xl shadow-lg p-4 md:p-6">
                <div class="flex flex-col md:flex-row items-center p-4 border-b border-gray-200 mb-6 bg-gray-50 rounded-t-lg">
                     <label for="kibana-filter" class="flex-shrink-0 mr-3 font-semibold text-gray-700">B·ªô l·ªçc (KQL):</label>
                     <select id="kibana-filter" class="w-full md:w-auto p-2 border rounded-md bg-white">
                         <option value="*">T·∫•t c·∫£ Log</option>
                         <option value="http.response.status_code >= 500">Ch·ªâ L·ªói Server (5xx)</option>
                         <option value="log.level: ERROR">Ch·ªâ Log Level ERROR</option>
                         <option value="http.request.method: POST">Ch·ªâ Request POST</option>
                     </select>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Log Volume -->
                    <div class="col-span-1 md:col-span-2 lg:col-span-3 bg-gray-50 p-4 rounded-lg">
                        <h3 class="font-semibold mb-2">Kh·ªëi l∆∞·ª£ng Log theo Th·ªùi gian</h3>
                        <div class="chart-container">
                            <canvas id="logVolumeChart"></canvas>
                        </div>
                    </div>
                    <!-- Status Codes -->
                    <div class="col-span-1 lg:col-span-1 bg-gray-50 p-4 rounded-lg">
                        <h3 class="font-semibold mb-2">Ph√¢n b·ªï M√£ Tr·∫°ng th√°i HTTP</h3>
                        <div class="chart-container">
                            <canvas id="statusCodesChart"></canvas>
                        </div>
                    </div>
                    <!-- Log Levels -->
                     <div class="col-span-1 lg:col-span-1 bg-gray-50 p-4 rounded-lg">
                        <h3 class="font-semibold mb-2">Ph√¢n b·ªï C·∫•p ƒë·ªô Log</h3>
                         <div class="chart-container">
                            <canvas id="logLevelsChart"></canvas>
                        </div>
                    </div>
                    <!-- Top IPs -->
                    <div class="col-span-1 lg:col-span-1 bg-gray-50 p-4 rounded-lg">
                        <h3 class="font-semibold mb-2">Top 5 IP ngu·ªìn</h3>
                        <div id="topIpsTable" class="space-y-2 pt-2"></div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Section: Best Practices -->
        <section id="best-practices" class="scroll-mt-20">
             <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4 text-center">Th·ª±c h√†nh T·ªët nh·∫•t</h2>
            <p class="max-w-3xl mx-auto text-lg text-gray-600 mb-12 text-center">ƒê·ªÉ x√¢y d·ª±ng m·ªôt h·ªá th·ªëng ph√¢n t√≠ch log m·∫°nh m·∫Ω v√† b·ªÅn v·ªØng, h√£y tu√¢n th·ªß c√°c nguy√™n t·∫Øc c·ªët l√µi sau.</p>
            <div class="max-w-3xl mx-auto space-y-4">
                <div class="accordion-item bg-white rounded-lg shadow">
                    <button class="accordion-header w-full flex justify-between items-center p-5 text-left font-semibold">
                        <span>üìù Ghi Log c√≥ C·∫•u tr√∫c (Structured Logging)</span>
                        <span class="accordion-icon transform transition-transform text-xl text-[#a3b8c2]">+</span>
                    </button>
                    <div class="accordion-content px-5">
                        <p class="py-4 text-gray-600">Thay v√¨ ghi log d·∫°ng vƒÉn b·∫£n t·ª± do, h√£y s·ª≠ d·ª•ng ƒë·ªãnh d·∫°ng c√≥ c·∫•u tr√∫c nh∆∞ JSON. ƒêi·ªÅu n√†y gi√∫p lo·∫°i b·ªè b∆∞·ªõc ph√¢n t√≠ch c√∫ ph√°p ph·ª©c t·∫°p, l√†m cho vi·ªác l·∫≠p ch·ªâ m·ª•c v√† t√¨m ki·∫øm tr·ªü n√™n nhanh h∆°n v√† ƒë√°ng tin c·∫≠y h∆°n r·∫•t nhi·ªÅu. ƒê√¢y l√† n·ªÅn t·∫£ng cho m·ªôt h·ªá th·ªëng logging hi·ªáu qu·∫£.</p>
                    </div>
                </div>
                 <div class="accordion-item bg-white rounded-lg shadow">
                    <button class="accordion-header w-full flex justify-between items-center p-5 text-left font-semibold">
                        <span>üè∑Ô∏è Chu·∫©n h√≥a v·ªõi Elastic Common Schema (ECS)</span>
                         <span class="accordion-icon transform transition-transform text-xl text-[#a3b8c2]">+</span>
                    </button>
                    <div class="accordion-content px-5">
                        <p class="py-4 text-gray-600">√Åp d·ª•ng ECS ƒë·ªÉ chu·∫©n h√≥a t√™n tr∆∞·ªùng trong d·ªØ li·ªáu c·ªßa b·∫°n (v√≠ d·ª•: lu√¥n d√πng `client.ip` cho ƒë·ªãa ch·ªâ IP c·ªßa client). ƒêi·ªÅu n√†y gi√∫p b·∫°n d·ªÖ d√†ng t∆∞∆°ng quan d·ªØ li·ªáu t·ª´ c√°c ngu·ªìn kh√°c nhau v√† t·∫≠n d·ª•ng c√°c dashboard, rule ƒë∆∞·ª£c x√¢y d·ª±ng s·∫µn trong Kibana.</p>
                    </div>
                </div>
                 <div class="accordion-item bg-white rounded-lg shadow">
                    <button class="accordion-header w-full flex justify-between items-center p-5 text-left font-semibold">
                        <span>üîÑ T·ª± ƒë·ªông h√≥a V√≤ng ƒë·ªùi D·ªØ li·ªáu (ILM)</span>
                         <span class="accordion-icon transform transition-transform text-xl text-[#a3b8c2]">+</span>
                    </button>
                    <div class="accordion-content px-5">
                        <p class="py-4 text-gray-600">Kh√¥ng ph·∫£i t·∫•t c·∫£ d·ªØ li·ªáu ƒë·ªÅu c·∫ßn ƒë∆∞·ª£c l∆∞u tr·ªØ v·ªõi chi ph√≠ v√† hi·ªáu nƒÉng cao nh·∫•t. H√£y c·∫•u h√¨nh Index Lifecycle Management (ILM) ƒë·ªÉ t·ª± ƒë·ªông di chuy·ªÉn d·ªØ li·ªáu c≈© sang c√°c t·∫ßng l∆∞u tr·ªØ r·∫ª h∆°n (Warm, Cold) v√† cu·ªëi c√πng l√† x√≥a ch√∫ng, gi√∫p ti·∫øt ki·ªám chi ph√≠ ƒë√°ng k·ªÉ.</p>
                    </div>
                </div>
                <div class="accordion-item bg-white rounded-lg shadow">
                    <button class="accordion-header w-full flex justify-between items-center p-5 text-left font-semibold">
                        <span>üîê B·∫£o m·∫≠t H·ªá th·ªëng</span>
                         <span class="accordion-icon transform transition-transform text-xl text-[#a3b8c2]">+</span>
                    </button>
                    <div class="accordion-content px-5">
                        <p class="py-4 text-gray-600">B·∫£o v·ªá d·ªØ li·ªáu log c·ªßa b·∫°n b·∫±ng c√°ch b·∫≠t x√°c th·ª±c v√† ph√¢n quy·ªÅn (RBAC). M√£ h√≥a giao ti·∫øp gi·ªØa c√°c th√†nh ph·∫ßn trong stack b·∫±ng TLS/SSL. ƒê·ª´ng b·ªè qua vi·ªác che gi·∫•u ho·∫∑c lo·∫°i b·ªè c√°c th√¥ng tin nh·∫°y c·∫£m (PII) kh·ªèi log tr∆∞·ªõc khi l·∫≠p ch·ªâ m·ª•c.</p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-gray-800 text-white mt-16 md:mt-24">
        <div class="container mx-auto py-6 px-4 sm:px-6 lg:px-8 text-center">
            <p>T·∫°o ra ƒë·ªÉ kh√°m ph√° s·ª©c m·∫°nh c·ªßa Elastic Stack.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const chartColors = {
                blue: 'rgba(163, 184, 194, 0.7)',
                tan: 'rgba(216, 195, 165, 0.7)',
                coral: 'rgba(233, 128, 116, 0.7)',
                gray: 'rgba(142, 141, 138, 0.7)',
                blueBorder: 'rgb(163, 184, 194)',
                tanBorder: 'rgb(216, 195, 165)',
                coralBorder: 'rgb(233, 128, 116)',
                grayBorder: 'rgb(142, 141, 138)',
            };
            
            // --- Navigation Logic ---
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('main section');
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    // For mobile, close menu on click
                    if (!mobileMenu.classList.contains('hidden')) {
                         mobileMenu.classList.add('hidden');
                    }
                    // Smooth scroll for all nav links
                    const targetId = link.getAttribute('href');
                    if (targetId.startsWith('#')) {
                        e.preventDefault();
                        document.querySelector(targetId).scrollIntoView({
                            behavior: 'smooth'
                        });
                    }
                });
            });

            // Active nav link on scroll
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        navLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href').substring(1) === entry.target.id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { threshold: 0.5 });
            sections.forEach(section => observer.observe(section));
            
            // --- Flowchart Logic ---
            const flowchartNodes = document.querySelectorAll('.flowchart-node');
            flowchartNodes.forEach(node => {
                node.addEventListener('click', () => {
                    const targetId = node.dataset.target;
                    document.querySelector(targetId).scrollIntoView({ behavior: 'smooth', block: 'start' });
                });
            });

            // --- Collection Section Logic ---
            const collectorChartCtx = document.getElementById('collectorChart').getContext('2d');
            new Chart(collectorChartCtx, {
                type: 'bar',
                data: {
                    labels: ['Filebeat', 'Logstash', 'Elastic Agent'],
                    datasets: [{
                        label: 'S·ª≠ d·ª•ng t√†i nguy√™n',
                        data: [1, 3, 2], // 1: Low, 2: Medium, 3: High
                        backgroundColor: chartColors.blue,
                        borderColor: chartColors.blueBorder,
                        borderWidth: 1
                    }, {
                        label: 'Kh·∫£ nƒÉng bi·∫øn ƒë·ªïi',
                        data: [1.5, 3, 2.5], // 1: Basic, 2: Medium, 3: Rich
                        backgroundColor: chartColors.tan,
                        borderColor: chartColors.tanBorder,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value, index, values) {
                                    const labels = {0: 'Th·∫•p', 1: 'C∆° b·∫£n', 2: 'Trung b√¨nh', 3: 'Cao/Phong ph√∫'};
                                    return labels[Math.round(value)] || '';
                                }
                            }
                        }
                    },
                    plugins: {
                       tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    const value = context.parsed.y;
                                    const labels = {
                                        'S·ª≠ d·ª•ng t√†i nguy√™n': {1: 'Th·∫•p', 2: 'Trung b√¨nh', 3: 'Cao'},
                                        'Kh·∫£ nƒÉng bi·∫øn ƒë·ªïi': {1.5: 'C∆° b·∫£n', 2.5: 'Trung b√¨nh', 3: 'Phong ph√∫'}
                                    }
                                    label += labels[context.dataset.label][value];
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            const tabs = document.querySelectorAll('.custom-tab');
            const tabPanes = document.querySelectorAll('.tab-pane');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    const targetPaneId = tab.dataset.tab + '-content';
                    tabPanes.forEach(pane => {
                        if (pane.id === targetPaneId) {
                            pane.classList.remove('hidden');
                            pane.classList.add('active');
                        } else {
                            pane.classList.add('hidden');
                            pane.classList.remove('active');
                        }
                    });
                });
            });

            const filebeatCodeSnippets = {
                nginx: `filebeat.modules:
- module: nginx
  access:
    enabled: true
    var.paths: ["/var/log/nginx/access.log*"]
  error:
    enabled: true
    var.paths: ["/var/log/nginx/error.log*"]

output.elasticsearch:
  hosts: ["es-host:9200"]`,
                apache: `filebeat.modules:
- module: apache
  access:
    enabled: true
    var.paths: ["/var/log/apache2/access.log*"]
  error:
    enabled: true
    var.paths: ["/var/log/apache2/error.log*"]

output.elasticsearch:
  hosts: ["es-host:9200"]`,
                json: `filebeat.inputs:
- type: log
  paths:
    - /var/log/my_app/json.log
  processors:
    - decode_json_fields:
        fields: ["message"]
        target: ""

output.elasticsearch:
  hosts: ["es-host:9200"]`
            };
            const filebeatLogType = document.getElementById('filebeat-log-type');
            const filebeatCode = document.getElementById('filebeat-code');
            filebeatLogType.addEventListener('change', (e) => {
                filebeatCode.textContent = filebeatCodeSnippets[e.target.value];
            });
            filebeatCode.textContent = filebeatCodeSnippets.nginx;

            const logstashCodeSnippets = {
                apache: `input {
  beats {
    port => 5044
  }
}
filter {
  grok {
    match => { "message" => "%{COMBINEDAPACHELOG}" }
  }
  geoip {
    source => "clientip"
  }
}
output {
  elasticsearch {
    hosts => ["http://es-host:9200"]
    index => "weblogs-%{+YYYY.MM.dd}"
  }
}`,
                syslog: `input {
  syslog {
    port => 514
    type => "syslog"
  }
}
filter {
  grok {
    match => { "message" => "<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{DATA:syslog_program}: %{GREEDYDATA:syslog_message}" }
  }
}
output {
  elasticsearch {
    hosts => ["http://es-host:9200"]
    index => "syslog-%{+YYYY.MM.dd}"
  }
}`,
                beats: `input {
  beats {
    port => 5044
  }
}
# ... filter section depends on data from Beats ...
filter {
  if [fileset][name] == "nginx" {
     # Nginx specific processing
  }
}
output {
  elasticsearch {
    hosts => ["http://es-host:9200"]
  }
}`
            };
            const logstashLogType = document.getElementById('logstash-log-type');
            const logstashCode = document.getElementById('logstash-code');
            logstashLogType.addEventListener('change', (e) => {
                logstashCode.textContent = logstashCodeSnippets[e.target.value];
            });
            logstashCode.textContent = logstashCodeSnippets.apache;

            // --- Processing Section Logic ---
            const grokInput = document.getElementById('grok-input');
            const grokPattern = document.getElementById('grok-pattern');
            const grokParseBtn = document.getElementById('grok-parse-btn');
            const grokOutput = document.getElementById('grok-output');

            grokParseBtn.addEventListener('click', () => {
                // This is a simplified simulation
                const log = grokInput.value;
                if (log.includes('GET /apache_pb.gif HTTP/1.0')) {
                    const result = {
                        "clientip": "127.0.0.1",
                        "ident": "-",
                        "auth": "frank",
                        "timestamp": "10/Oct/2000:13:55:36 -0700",
                        "verb": "GET",
                        "request": "/apache_pb.gif",
                        "httpversion": "1.0",
                        "response": 200,
                        "bytes": 2326
                    };
                    grokOutput.textContent = JSON.stringify(result, null, 2);
                } else {
                    grokOutput.textContent = JSON.stringify({ "error": "M·∫´u Grok kh√¥ng kh·ªõp v·ªõi log ƒë·∫ßu v√†o. ƒê√¢y l√† m·ªôt v√≠ d·ª• m√¥ ph·ªèng." }, null, 2);
                }
            });

            const ilmPhases = document.querySelectorAll('.ilm-phase');
            ilmPhases.forEach(phase => {
                const details = phase.querySelector('.ilm-details');
                phase.addEventListener('mouseenter', () => {
                    details.classList.remove('hidden');
                });
                phase.addEventListener('mouseleave', () => {
                    details.classList.add('hidden');
                });
            });


            // --- Analysis Section Logic ---
            let logVolumeChart, statusCodesChart, logLevelsChart;
            const kibanaFilter = document.getElementById('kibana-filter');

            // Sample Data
            const baseData = [
                { time: '10:00', total: 120, status: {200: 100, 404: 15, 500: 5}, level: {INFO: 110, WARN: 5, ERROR: 5}, ip: '203.0.113.10', method: 'GET'},
                { time: '10:05', total: 150, status: {200: 130, 404: 18, 503: 2}, level: {INFO: 140, WARN: 8, ERROR: 2}, ip: '198.51.100.25', method: 'GET'},
                { time: '10:10', total: 135, status: {200: 110, 301: 20, 500: 5}, level: {INFO: 125, WARN: 5, ERROR: 5}, ip: '203.0.113.10', method: 'POST'},
                { time: '10:15', total: 180, status: {200: 165, 404: 10, 500: 5}, level: {INFO: 170, WARN: 5, ERROR: 5}, ip: '192.0.2.44', method: 'GET'},
                { time: '10:20', total: 250, status: {200: 220, 404: 25, 503: 5}, level: {INFO: 240, WARN: 5, ERROR: 5}, ip: '203.0.113.10', method: 'GET'},
                { time: '10:25', total: 160, status: {200: 150, 404: 8, 500: 2}, level: {INFO: 150, WARN: 8, ERROR: 2}, ip: '198.51.100.25', method: 'POST'}
            ];

            const filterData = (filter) => {
                if (filter === '*') return baseData;
                if (filter === 'http.response.status_code >= 500') {
                    return baseData.map(d => ({
                        ...d, 
                        total: (d.status['500'] || 0) + (d.status['503'] || 0)
                    })).filter(d => d.total > 0);
                }
                if (filter === 'log.level: ERROR') {
                    return baseData.map(d => ({...d, total: d.level.ERROR || 0})).filter(d => d.total > 0);
                }
                 if (filter === 'http.request.method: POST') {
                    return baseData.filter(d => d.method === 'POST');
                }
                return baseData;
            };

            const updateCharts = (filter) => {
                const data = filterData(filter);
                
                // Aggregate data for charts
                const labels = data.map(d => d.time);
                const volumeData = data.map(d => d.total);
                
                const statusCounts = data.reduce((acc, curr) => {
                    for (const code in curr.status) {
                        acc[code] = (acc[code] || 0) + curr.status[code];
                    }
                    return acc;
                }, {});
                
                const levelCounts = data.reduce((acc, curr) => {
                    for (const level in curr.level) {
                        acc[level] = (acc[level] || 0) + curr.level[level];
                    }
                    return acc;
                }, {});

                const ipCounts = data.reduce((acc, curr) => {
                    acc[curr.ip] = (acc[curr.ip] || 0) + 1;
                    return acc;
                }, {});
                const topIps = Object.entries(ipCounts).sort(([,a],[,b]) => b-a).slice(0, 5);

                // Update Log Volume Chart
                logVolumeChart.data.labels = labels;
                logVolumeChart.data.datasets[0].data = volumeData;
                logVolumeChart.update();
                
                // Update Status Codes Chart
                statusCodesChart.data.labels = Object.keys(statusCounts);
                statusCodesChart.data.datasets[0].data = Object.values(statusCounts);
                statusCodesChart.update();

                // Update Log Levels Chart
                logLevelsChart.data.labels = Object.keys(levelCounts);
                logLevelsChart.data.datasets[0].data = Object.values(levelCounts);
                logLevelsChart.data.datasets[0].backgroundColor = Object.keys(levelCounts).map(level => {
                    if (level === 'ERROR') return chartColors.coral;
                    if (level === 'WARN') return chartColors.tan;
                    return chartColors.blue;
                });
                logLevelsChart.update();

                // Update Top IPs Table
                const topIpsTable = document.getElementById('topIpsTable');
                topIpsTable.innerHTML = '';
                topIps.forEach(([ip, count]) => {
                    const row = document.createElement('div');
                    row.className = 'flex justify-between items-center text-sm p-2 rounded bg-white';
                    row.innerHTML = `<span class="font-mono text-gray-700">${ip}</span><span class="font-semibold text-[#3a3a3a]">${count} requests</span>`;
                    topIpsTable.appendChild(row);
                });
                if (topIps.length === 0) {
                     topIpsTable.innerHTML = '<p class="text-sm text-gray-500 text-center p-4">Kh√¥ng c√≥ d·ªØ li·ªáu cho b·ªô l·ªçc n√†y.</p>';
                }
            };

            const initCharts = () => {
                // Log Volume Chart
                const logVolumeCtx = document.getElementById('logVolumeChart').getContext('2d');
                logVolumeChart = new Chart(logVolumeCtx, {
                    type: 'line',
                    data: { labels: [], datasets: [{ label: 'S·ªë l∆∞·ª£ng Log', data: [], borderColor: chartColors.blueBorder, backgroundColor: chartColors.blue, tension: 0.1, fill: true }] },
                    options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true } } }
                });

                // Status Codes Chart
                const statusCtx = document.getElementById('statusCodesChart').getContext('2d');
                statusCodesChart = new Chart(statusCtx, {
                    type: 'doughnut',
                    data: { labels: [], datasets: [{ label: 'M√£ Tr·∫°ng th√°i', data: [], backgroundColor: [chartColors.blue, chartColors.tan, chartColors.coral, chartColors.gray] }] },
                    options: { responsive: true, maintainAspectRatio: false }
                });

                // Log Levels Chart
                const levelCtx = document.getElementById('logLevelsChart').getContext('2d');
                logLevelsChart = new Chart(levelCtx, {
                    type: 'pie',
                    data: { labels: [], datasets: [{ label: 'C·∫•p ƒë·ªô Log', data: [], backgroundColor: [] }] },
                    options: { responsive: true, maintainAspectRatio: false }
                });
                
                updateCharts('*');
            };

            kibanaFilter.addEventListener('change', (e) => {
                updateCharts(e.target.value);
            });
            
            initCharts();

            // --- Accordion Logic ---
            const accordionItems = document.querySelectorAll('.accordion-item');
            accordionItems.forEach(item => {
                const header = item.querySelector('.accordion-header');
                const content = item.querySelector('.accordion-content');
                const icon = item.querySelector('.accordion-icon');
                header.addEventListener('click', () => {
                    const isOpen = !content.style.maxHeight || content.style.maxHeight === '0px';
                    // Close all others
                    accordionItems.forEach(otherItem => {
                        if (otherItem !== item) {
                            otherItem.querySelector('.accordion-content').style.maxHeight = '0px';
                            otherItem.querySelector('.accordion-icon').textContent = '+';
                            otherItem.querySelector('.accordion-icon').classList.remove('rotate-45');
                        }
                    });

                    if (isOpen) {
                        content.style.maxHeight = content.scrollHeight + 'px';
                        icon.textContent = '‚àí';
                        icon.classList.add('rotate-45');
                    } else {
                        content.style.maxHeight = '0px';
                        icon.textContent = '+';
                        icon.classList.remove('rotate-45');
                    }
                });
            });

        });
    </script>
</body>
</html>
